#
# define display information
#
name: View Function Profile for Genomes - v1.4.0

tooltip: |
    Examine the general functional distribution or specific functional gene families for a GenomeSet.

screenshots:
    []

icon: domains_profile-purple.png

#
# define a set of similar methods that might be useful to the user
#
suggestions:
    apps:
        related:
            []
        next:
            []
    methods:
        related:
            []
        next:
            []

#
# Configure the display and description of parameters
#
parameters :
    input_genomeSet_ref :
        ui-name : |
            GenomeSet
        short-hint : |
            The set of Genomes to examine.
    namespace :
        ui-name : |
            Domain Namespace
        short-hint : |
            Select between a top-level domain source or use of custom domains.
    target_fams :
        ui-name : |
            Custom Domains
        short-hint : |
            Specify domain families to display in the viewer using a comma to separate terms, e.g. PF00007, COG0007. The default is to display all annotated domains.
    extra_target_fam_groups_COG :
        ui-name : |
            Custom Domain Groups (COG)
        short-hint : |
            Select COG domain group from the dropdown list, e.g., N:Cell Motility, for displaying hits in the viewer.
    extra_target_fam_groups_PFAM :
        ui-name : |
            Custom Domain Groups (PFAM)
        short-hint : |
            Select PFAM clan from the dropdown list, e.g., CL0181:ABC-2-transporter-like clan, for displaying hits in the viewer.
    extra_target_fam_groups_TIGR :
        ui-name : |
            Custom Domain Groups (TIGRFAM)
        short-hint : |
            Select TIGR role from the dropdown list, e.g., role 13010:Biosynthesis, for displaying hits in the viewer.
    extra_target_fam_groups_SEED :
        ui-name : |
            SEED Functional Group
        short-hint : |
            Select SEED-defined Functional Category from the dropdown list, e.g., Alanine Biosynthesis, for displaying hits in the viewer. Requires RAST annotated genomes.
    count_category :
        ui-name : |
            View values as
        short-hint : |
            Calculate hits as percentages of total genes or as raw counts of genes.
    heatmap :
        ui-name : |
            View table as
        short-hint : |
            Display as color heatmap or numerical table of domain hit counts.
    log_base :
        ui-name : |
            Heatmap Log Base (optional)
        short-hint : |
            To switch from linear (default) to log base, set a log base for rendering the heatmap values.
    e_value :
        ui-name : |
            E-value Upper Limit
        short-hint : |
            Hit count calculation ignores domain hits above the specified e-value threshold.
    top_hit :
        ui-name : |
            Count annotated genes using
        short-hint : |
            Count only the top hit per gene within a namespace (e.g. Pfam).
    required_COG_annot_perc :
        ui-name : |
            Genes requiring COG annot
        short-hint : |
            Percentage of ALL genes that need to have a COG annotation to consider Domain Annotation valid
    required_PFAM_annot_perc :
        ui-name : |
            Genes requiring PFAM annot
        short-hint : |
            Percentage of ALL genes that need to have a PFAM annotation to consider Domain Annotation of the Genome valid
    required_TIGR_annot_perc :
        ui-name : |
            Genes requiring TIGR annot
        short-hint : |
            Percentage of ALL genes that need to have a TIGR annotation to consider Domain Annotation of the Genome valid
    required_SEED_annot_perc :
        ui-name : |
            Genes with validated SEED annot
        short-hint : |
            Percentage of genes with annotations required to match to the SEED namespace to consider the SEED annotation of the Genome valid
    count_hypothetical :
        ui-name : |
            Count SEED hypothetical
        short-hint : |
            Should genes with SEED 'hypothetical' annotation be considered in count of annotated genes
    show_blanks :
        ui-name : |
            Empty categories
        short-hint : |
            Show categories or families that have no counts.
    display_genome_object_name :
        ui-name : |
            Display genome object name
        short-hint : |
            In addition to the Scientific Name, include the name of the Genome Object in the function profile report
    skip_missing_genomes :
        ui-name : |
            Skip missing genomes
        short-hint : |
            Remove genomes from analysis if no corresponding Domain Annotation object found.
    enforce_genome_version_match :
        ui-name : |
            Enforce genome version match
        short-hint : |
            Require that the genome version used matches the genome version found in the Domain Annotation. Default is to use newest Genome version found in Narrative.

#
# Configure the display and description of parameters
#
parameter-groups :
    custom_target_fams :
        ui-name : |
            Custom Domains (including namespace groups)
        short-hint : |
            Enable and define custom domains to use. The default is to display all annotated domains.

description : |
    <p>This App constructs a heatmap or numeric table showing protein domains that are present in the genomes of all the organisms contained in a phylogenetic species tree. It is recommended to use genomes annotated with RAST if you want to analyze SEED roles, but genomes annotated with Prokka or other tools are fine for other domain namespaces.</p>

    <p>You must perform domain annotation on all of the genomes to feed into this viewer, by using the <a href=”https://narrative.kbase.us/#appcatalog/app/DomainAnnotation/annotate_domains_in_a_genome/release”>Annotate Domains in a Genome</a> App or the <a href=”https://narrative.kbase.us/#appcatalog/app/kb_phylogenomics/run_DomainAnnotation_Sets/release”>Annotate Domains in a GenomeSet</a> App on a GenomeSet. If there are any genomes present in the Genome Set that are not annotated with domains, the App will fail. The error message “MISSING DOMAIN ANNOTATION FOR: 43454/34/1” indicates which genome in the Data Panel needs domain annotation. Check that all of the genomes in the tree have corresponding Genome and Domain Annotation objects in your Data Panel. These steps are required to ensure this viewer will function properly. The user can choose to ignore genomes which are missing corresponding Domain Annotations by setting <i>Skip missing genomes</i>. Additionally the Domain Annotation objects are linked to the version of the Genome object that was annotated, but it may be that the version of the Genome object has incremented, so the default behavior is to use the newest version of the Genome found in the workspace.</p>

    <p>You can use this App to examine the general domain distribution or specific functional gene families for all the genomes in the species tree, sorted according to their position in the tree. Choose a Domain Namespace to view hits for all protein domain terms from COG Functional Categories, Pfam A Clans, TIGRfam Roles, and SEED Roles. Enable and set the Custom Domains parameters to limit the report to a subselection of terms. The output report can be a heatmap to visualize the degree of hits for genes that correspond to motifs associated with protein domains, or a numeric table containing the count of hits. The output report also provides a key for the functional domain terms from each of these databases; terms not associated with any hits will appear with grey background color.</p>

    <p><strong>Team members who developed &amp; deployed algorithm in KBase:</strong> Dylan Chivian. For questions, please <a href=”http://kbase.us/contact-us/”>contact us</a>.</p>

publications :
    -
        display-text: |
            Arkin AP, Cottingham RW, Henry CS, Harris NL, Stevens RL, Maslov S, et al. KBase: The United States Department of Energy Systems Biology Knowledgebase. Nature Biotechnology. 2018;36: 566. doi: 10.1038/nbt.4163
        link: https://www.nature.com/articles/nbt.4163
